{"version":3,"sources":["EditMenu.jsx","initialConfig.js","Tiergarten.jsx","App.js","index.js"],"names":["LargeEmoji","children","className","EditMenu","props","Object","entries","config","participantTypes","map","participantType","typeConfig","onClick","handleClick","emoji","label","state","initialConfig","rabbit","requirements","legs","shirts","cricket","octopus","materialNames","persons","materialKeysVector","participantTypeKeysVector","participantTypesToMatrix","jStat","material","transpose","fixValue","value","Math","round","guessCounts","values","inverseMatrix","participantsVectorToState","multiply","valuesToMaterialsVector","toArray","GuessCountsForm","useState","fromEntries","keys","setValues","handleChange","event","newValues","assign","target","name","class","onSubmit","guessedCounts","console","log","updateValues","preventDefault","count","type","min","required","placeholder","materialCounts","onChange","getMaterialCounts","materialsVectorToValues","stateToParticipantsVector","floor","Tiergarten","participantPropsByType","handleDelete","participants","reduce","result","concat","Array","from","key","data-tooltip","alt","makeParticipantsForType","content","length","requirementsMatrixJ","requirementsMatrix","inv","roundAt","x","decimals","pow","row","col","buildInitialState","reducer","action","nextState","App","useReducer","dispatch","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.a8479efa.chunk.js","sourcesContent":["import React from \"react\";\n\nconst LargeEmoji = ({children}) => (\n  <div className=\"large-emoji\">{children}</div>\n)\n\nconst EditMenu = (props) => (\n  <div className=\"ui labeled icon menu\">{\n    Object.entries(props.config.participantTypes)\n    .map(([participantType, typeConfig]) => (\n      <a\n        key={participantType}\n        className={`item add-{participantType}`}\n        onClick={props.handleClick(participantType)}\n      >\n        <LargeEmoji>{typeConfig.emoji}</LargeEmoji>\n        {typeConfig.label}\n        <div className=\"ui top right attached label\">\n          {props.state[participantType]}\n        </div>\n      </a>\n    ))\n  }</div>\n);\n\nexport default EditMenu;\n","const initialConfig = {\n  participantTypes: {\n    rabbit: {\n      label: \"Hase\",\n      emoji: \"🐇\",\n      requirements: {\n        legs: 4,\n        shirts: 1\n      }\n    },\n    cricket: {\n      label: \"Grille\",\n      emoji: \"🦗\",\n      requirements: {\n        legs: 6,\n        shirts: 0\n      }\n    },\n    octopus: {\n      label: \"Oktopus\",\n      emoji: \"🐙\",\n      requirements: {\n        legs: 8,\n        shirts: 0\n      }\n    },\n  }\n};\n\nexport default initialConfig;\n","import React, { useState } from \"react\";\nimport { jStat } from \"jstat\";\n\nconst makeParticipantsForType = (participantType, count, typeConfig, props) =>\n  Array.from(Array(count).entries()).map(([key, __]) => (\n    <a\n      key={participantType + key}\n      data-tooltip=\"entfernen\"\n      alt={typeConfig.label}\n      {...props}\n    >\n      {typeConfig.emoji}\n    </a>\n  ));\n\nconst materialNames = {\n  persons: \"Stirnbänder\",\n  legs: \"Socken\",\n  shirts: \"T-Shirts (leider nur für Hasen)\"\n};\n\nconst materialKeysVector = [\"persons\", \"legs\", \"shirts\"];\nconst participantTypeKeysVector = [\"rabbit\", \"cricket\", \"octopus\"];\n\nconst materialsVectorToValues = ([persons, legs, shirts]) => ({\n  persons,\n  legs,\n  shirts\n});\n\nconst valuesToMaterialsVector = values => jStat([\n  values.persons,\n  values.legs,\n  values.shirts\n]).transpose();\n\nconst participantsVectorToState = ([rabbit, cricket, octopus]) => ({\n  rabbit,\n  cricket,\n  octopus\n});\n\nconst stateToParticipantsVector = state => jStat([\n  state.rabbit,\n  state.cricket,\n  state.octopus\n]).transpose();\n\nconst participantTypesToMatrix = participantTypes =>\n  jStat(\n    participantTypeKeysVector.map(participantType => {\n      const requirements = participantTypes[participantType].requirements;\n      return materialKeysVector.map(material =>\n        material === \"persons\" ? 1 : requirements[material]\n      );\n    })\n  ).transpose();\n\nconst fixValue = value => (value < 0 ? 0 : Math.round(value));\n\nconst guessCounts = (values, inverseMatrix) =>\n  participantsVectorToState(\n    jStat(inverseMatrix)\n      .multiply(valuesToMaterialsVector(values))\n      .toArray()\n      .map(fixValue)\n  );\n\nconst GuessCountsForm = props => {\n  const [values, setValues] = useState(() =>\n    Object.fromEntries(\n      Object.keys(materialNames).map(material => [material, \"\"])\n    )\n  );\n\n  const handleChange = event => {\n    const newValues = Object.assign({}, values);\n    newValues[event.target.name] = event.target.value;\n    setValues(newValues);\n  };\n\n  const handleSubmit = event => {\n    const guessedCounts = guessCounts(values, props.inverseMatrix);\n    console.log(\"submit\", values, guessedCounts);\n    props.updateValues(guessedCounts);\n    event.preventDefault();\n  };\n\n  return (\n    <form class=\"ui form\" onSubmit={handleSubmit}>\n      <div class=\"fields\">\n        {Object.entries(values).map(([material, count]) => (\n          <div class=\"field\" key={material}>\n            <label>{materialNames[material]}</label>\n            <input\n              type=\"number\"\n              min=\"0\"\n              required\n              name={material}\n              placeholder={props.materialCounts[material]}\n              value={count}\n              onChange={handleChange}\n            />\n          </div>\n        ))}\n      </div>\n      <button class=\"ui button\" type=\"submit\">\n        Teilnehmer*innenzahlen erraten\n      </button>\n    </form>\n  );\n};\n\nconst getMaterialCounts = (state, participantTypes) =>\n  materialsVectorToValues(\n    participantTypesToMatrix(participantTypes)\n      .multiply(stateToParticipantsVector(state))\n      .toArray()\n      .map(Math.floor)\n  );\n\nconst Tiergarten = props => {\n  const participantTypes = props.config.participantTypes;\n  console.log(\"mat\", participantTypesToMatrix(participantTypes));\n  const materialCounts = getMaterialCounts(props.state, participantTypes);\n  const participantPropsByType = Object.fromEntries(\n    participantTypeKeysVector.map(participantType => [\n      [participantType],\n      { onClick: props.handleDelete(participantType) },\n    ])\n  );\n  const participants = Object.entries(props.state).reduce(\n    (result, [participantType, count]) =>\n      result.concat(\n        makeParticipantsForType(\n          participantType,\n          count,\n          participantTypes[participantType],\n          participantPropsByType[participantType]\n        )\n      ),\n    []\n  );\n  const content = participants.length ? participants : \"leerer Tiergarten…\";\n  const requirementsMatrixJ = participantTypesToMatrix(participantTypes);\n  const requirementsMatrix = requirementsMatrixJ.toArray();\n  const inverseMatrix = jStat.inv(requirementsMatrixJ);\n  const roundAt = (x, decimals) => (\n    Math.pow(10, -decimals) * Math.round(Math.pow(10, decimals) * x)\n  );\n  return (\n    <>\n      <div class=\"ui card\">\n        <div class=\"image\">\n          <div class=\"tiergarten\">{content}</div>\n        </div>\n        <div class=\"content\">\n          <h2 class=\"header\">Benötigte Materialien</h2>\n          {Object.entries(materialCounts).map(([material, count]) => (\n            <div class=\"ui tiny horizontal statistic\" key={material}>\n              <div class=\"value\">{count}</div>\n              <div class=\"label\">{materialNames[material]}</div>\n            </div>\n          ))}\n        </div>\n        <div class=\"content\">\n          <h2 class=\"header\">Materialien schon da?</h2>\n          <GuessCountsForm\n            materialCounts={materialCounts}\n            updateValues={props.updateValues}\n            inverseMatrix={inverseMatrix}\n          />\n        </div>\n      </div>\n      <div className=\"ui card\">\n        <div class=\"content\">\n          <h2 className=\"header\">Materialien-Matrix</h2>\n          <table className=\"ui celled table\">\n            <thead><tr>{participantTypeKeysVector.map(participantType => (\n              <th>je {participantTypes[participantType].label}</th>\n            ))}</tr></thead>\n            <tbody>{ requirementsMatrix.map(row => (\n              <tr>{row.map(col => <td>{roundAt(col, 2)}</td>)}</tr>\n            )) }</tbody>\n          </table>\n        </div>\n        <div class=\"content\">\n          <h2 className=\"header\">Inverse Matrix</h2>\n          <table className=\"ui celled table\"><tbody>{inverseMatrix.map(row => (\n            <tr>{row.map(col => <td>{roundAt(col, 2)}</td>)}</tr>\n          ))}</tbody></table>\n        </div>\n      </div>\n    </>\n  );\n};\n\nexport default Tiergarten;\n","import React, { useReducer, useState } from \"react\";\nimport EditMenu from \"./EditMenu\";\nimport initialConfig from \"./initialConfig\";\nimport Tiergarten from \"./Tiergarten\";\nimport \"./style.css\";\nimport \"fomantic-ui-css/semantic.css\";\n\nconst buildInitialState = (config) => Object.fromEntries(\n  Object.keys(config.participantTypes)\n  .map(participantType => [participantType, 0])\n);\n\nconst reducer = (state, action) => {\n  const nextState = Object.assign({}, state);\n  switch(action.type) {\n    case \"update\":\n      Object.assign(nextState, action.values);\n      return nextState;\n    case \"add\":\n      nextState[action.participantType] += 1;\n      return nextState;\n    case \"delete\":\n      nextState[action.participantType] -= 1;\n      return nextState;\n  }\n};\n\nconst App = () => {\n  const [config, setConfig] = useState(initialConfig);\n  const [state, dispatch] = useReducer(reducer, config, buildInitialState);\n  const updateValues = values => {\n    dispatch({ type: \"update\", values })\n  };\n  const handleAdd = participantType => event => {\n    dispatch({ type: \"add\", participantType });\n    console.log(state);\n  };\n  const handleDelete = participantType => event => {\n    dispatch({ type: \"delete\", participantType });\n    console.log(state);\n  };\n  return (\n    <div className=\"ui container\">\n      <h1 className=\"ui header\">Tiergarten</h1>\n      <p className=\"ui info message\">\n        Klick auf die Teilnehmer*innen-Knöpfe, damit sie in den Tiergarten\n        kommen!\n      </p>\n      <EditMenu\n        config={config}\n        state={state}\n        handleClick={handleAdd}\n      />\n      <div className=\"ui cards\">\n        <Tiergarten\n          config={config}\n          state={state}\n          updateValues={updateValues}\n          handleDelete={handleDelete}\n        />\n      </div>\n    </div>\n  );\n};\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\n\nimport App from \"./App\";\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n"],"sourceRoot":""}